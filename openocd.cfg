################################################################################
# OpenOCD 配置文件 - STM32F446RET6
# 
# 用途：用于通过 ST-Link 调试和烧录 STM32F4 系列芯片
# 
# 使用方法：
#   openocd -f openocd.cfg
#   或配合烧录命令：
#   openocd -f openocd.cfg -c "program build/finger.elf verify reset exit"
################################################################################

# ==============================================================================
# 1. 调试接口配置
# ==============================================================================
# 选择 ST-Link V2 作为调试适配器
# 注意：如果是 ST-Link V1 或 V2.1，请修改为对应的配置文件
#   - ST-Link V1: interface/stlink-v1.cfg
#   - ST-Link V2.1: interface/stlink-v2-1.cfg
source [find interface/stlink-v2.cfg]

# ==============================================================================
# 2. 传输协议配置
# ==============================================================================
# 使用 SWD (Serial Wire Debug) 协议
# 优点：只需要 2 根线（SWDIO, SWCLK），比 JTAG 更简单
transport select hla_swd

# 如果使用 JTAG 接口，请取消下面几行的注释并注释掉上面的 SWD 配置
# source [find interface/stlink.cfg]
# transport select hla_jtag

# ==============================================================================
# 3. 目标芯片配置
# ==============================================================================
# 选择 STM32F4x 系列目标芯片配置文件
source [find target/stm32f4x.cfg]

# ==============================================================================
# 4. 性能配置
# ==============================================================================
# 设置适配器通信速度（单位：kHz）
# 范围：通常 100-8000 kHz
# 建议：
#   - 1000 kHz：稳定可靠，推荐用于烧录
#   - 更高速度：调试时使用，但可能不稳定
adapter_khz 1000

# ==============================================================================
# 5. 复位配置
# ==============================================================================
# 复位方式：使用软件复位（不依赖硬件复位线 nRST）
# 优点：即使 ST-Link 的 nRST 线未连接或连接不稳定也能正常工作
# 其他选项：
#   - srst_only：仅使用硬件复位（需要 nRST 线连接）
#   - srst_nogate：硬件复位但不门控
reset_config none separate

# ==============================================================================
# 6. 可选配置（默认已注释，按需启用）
# ==============================================================================

# 6.1 初始化后自动停止（用于调试）
# init
# halt

# 6.2 烧录命令示例（通常在命令行中使用，不在此配置文件中）
# program build/finger.elf verify reset exit
# 参数说明：
#   - program：烧录文件
#   - verify：烧录后验证
#   - reset：自动复位并运行
#   - exit：完成后退出

# ==============================================================================
# 7. GDB 调试服务器信息（默认配置，无需修改）
# ==============================================================================
# 默认端口：
#   - 3333：GDB 连接端口
#   - 4444：Telnet 命令接口
#   - 6666：TCL 脚本接口
# 
# 使用 GDB 调试：
#   gdb-multiarch build/finger.elf
#   (gdb) target remote localhost:3333
#   (gdb) monitor reset halt
#   (gdb) load
#   (gdb) continue

################################################################################
# 配置文件结束
################################################################################
