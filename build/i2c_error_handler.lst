ARM GAS  /tmp/cckYNZki.s 			page 1


   1              		.cpu cortex-m4
   2              		.eabi_attribute 27, 1
   3              		.eabi_attribute 28, 1
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"i2c_error_handler.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.HAL_I2C_ErrorCallback,"ax",%progbits
  18              		.align	1
  19              		.global	HAL_I2C_ErrorCallback
  20              		.arch armv7e-m
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  24              		.fpu fpv4-sp-d16
  26              	HAL_I2C_ErrorCallback:
  27              	.LVL0:
  28              	.LFB134:
  29              		.file 1 "Core/Src/i2c_error_handler.c"
   1:Core/Src/i2c_error_handler.c **** /**
   2:Core/Src/i2c_error_handler.c ****   ******************************************************************************
   3:Core/Src/i2c_error_handler.c ****   * @file    i2c_error_handler.c
   4:Core/Src/i2c_error_handler.c ****   * @brief   I2C error detection and recovery implementation
   5:Core/Src/i2c_error_handler.c ****   ******************************************************************************
   6:Core/Src/i2c_error_handler.c ****   * @attention
   7:Core/Src/i2c_error_handler.c ****   *
   8:Core/Src/i2c_error_handler.c ****   * This file implements I2C bus error recovery mechanisms to prevent
   9:Core/Src/i2c_error_handler.c ****   * permanent bus lockup when communication errors occur.
  10:Core/Src/i2c_error_handler.c ****   *
  11:Core/Src/i2c_error_handler.c ****   ******************************************************************************
  12:Core/Src/i2c_error_handler.c ****   */
  13:Core/Src/i2c_error_handler.c **** 
  14:Core/Src/i2c_error_handler.c **** #include "main.h"
  15:Core/Src/i2c_error_handler.c **** #include "i2c.h"
  16:Core/Src/i2c_error_handler.c **** #include "i2c_dma_manager.h"
  17:Core/Src/i2c_error_handler.c **** 
  18:Core/Src/i2c_error_handler.c **** /* Error statistics counters */
  19:Core/Src/i2c_error_handler.c **** volatile uint32_t i2c_error_count = 0;
  20:Core/Src/i2c_error_handler.c **** volatile uint32_t i2c_timeout_count = 0;
  21:Core/Src/i2c_error_handler.c **** volatile uint32_t i2c_bus_error_count = 0;
  22:Core/Src/i2c_error_handler.c **** volatile uint32_t i2c_arbitration_lost_count = 0;
  23:Core/Src/i2c_error_handler.c **** volatile uint32_t i2c_recovery_count = 0;
  24:Core/Src/i2c_error_handler.c **** 
  25:Core/Src/i2c_error_handler.c **** /* Health monitoring */
  26:Core/Src/i2c_error_handler.c **** static volatile uint32_t i2c_last_successful_transaction = 0;
  27:Core/Src/i2c_error_handler.c **** static volatile uint32_t i2c_consecutive_failures = 0;
  28:Core/Src/i2c_error_handler.c **** #define MAX_CONSECUTIVE_FAILURES 50  // Increased threshold - be more conservative
  29:Core/Src/i2c_error_handler.c **** #define HEALTH_CHECK_INTERVAL_MS 5000  // Check every 5 seconds
ARM GAS  /tmp/cckYNZki.s 			page 2


  30:Core/Src/i2c_error_handler.c **** 
  31:Core/Src/i2c_error_handler.c **** /**
  32:Core/Src/i2c_error_handler.c ****   * @brief  I2C error callback - automatically called by HAL on I2C errors
  33:Core/Src/i2c_error_handler.c ****   * @param  hi2c Pointer to a I2C_HandleTypeDef structure
  34:Core/Src/i2c_error_handler.c ****   * @retval None
  35:Core/Src/i2c_error_handler.c ****   */
  36:Core/Src/i2c_error_handler.c **** void HAL_I2C_ErrorCallback(I2C_HandleTypeDef *hi2c)
  37:Core/Src/i2c_error_handler.c **** {
  30              		.loc 1 37 1 view -0
  31              		.cfi_startproc
  32              		@ args = 0, pretend = 0, frame = 0
  33              		@ frame_needed = 0, uses_anonymous_args = 0
  38:Core/Src/i2c_error_handler.c ****     if (hi2c->Instance != I2C1) return;
  34              		.loc 1 38 5 view .LVU1
  35              		.loc 1 38 13 is_stmt 0 view .LVU2
  36 0000 0268     		ldr	r2, [r0]
  37              		.loc 1 38 8 view .LVU3
  38 0002 1F4B     		ldr	r3, .L13
  39 0004 9A42     		cmp	r2, r3
  40 0006 00D0     		beq	.L11
  41 0008 7047     		bx	lr
  42              	.L11:
  37:Core/Src/i2c_error_handler.c ****     if (hi2c->Instance != I2C1) return;
  43              		.loc 1 37 1 view .LVU4
  44 000a 10B5     		push	{r4, lr}
  45              	.LCFI0:
  46              		.cfi_def_cfa_offset 8
  47              		.cfi_offset 4, -8
  48              		.cfi_offset 14, -4
  49 000c 0446     		mov	r4, r0
  39:Core/Src/i2c_error_handler.c **** 
  40:Core/Src/i2c_error_handler.c ****     i2c_error_count++;
  50              		.loc 1 40 5 is_stmt 1 view .LVU5
  51              		.loc 1 40 20 is_stmt 0 view .LVU6
  52 000e 1D4A     		ldr	r2, .L13+4
  53 0010 1368     		ldr	r3, [r2]
  54 0012 0133     		adds	r3, r3, #1
  55 0014 1360     		str	r3, [r2]
  41:Core/Src/i2c_error_handler.c **** 
  42:Core/Src/i2c_error_handler.c ****     uint32_t error = HAL_I2C_GetError(hi2c);
  56              		.loc 1 42 5 is_stmt 1 view .LVU7
  57              		.loc 1 42 22 is_stmt 0 view .LVU8
  58 0016 FFF7FEFF 		bl	HAL_I2C_GetError
  59              	.LVL1:
  43:Core/Src/i2c_error_handler.c **** 
  44:Core/Src/i2c_error_handler.c ****     /* Log specific error types for diagnostics */
  45:Core/Src/i2c_error_handler.c ****     if (error & HAL_I2C_ERROR_TIMEOUT) {
  60              		.loc 1 45 5 is_stmt 1 view .LVU9
  61              		.loc 1 45 8 is_stmt 0 view .LVU10
  62 001a 10F0200F 		tst	r0, #32
  63 001e 03D0     		beq	.L3
  46:Core/Src/i2c_error_handler.c ****         i2c_timeout_count++;
  64              		.loc 1 46 9 is_stmt 1 view .LVU11
  65              		.loc 1 46 26 is_stmt 0 view .LVU12
  66 0020 194A     		ldr	r2, .L13+8
  67 0022 1368     		ldr	r3, [r2]
  68 0024 0133     		adds	r3, r3, #1
ARM GAS  /tmp/cckYNZki.s 			page 3


  69 0026 1360     		str	r3, [r2]
  70              	.L3:
  47:Core/Src/i2c_error_handler.c ****     }
  48:Core/Src/i2c_error_handler.c ****     if (error & HAL_I2C_ERROR_BERR) {
  71              		.loc 1 48 5 is_stmt 1 view .LVU13
  72              		.loc 1 48 8 is_stmt 0 view .LVU14
  73 0028 10F0010F 		tst	r0, #1
  74 002c 03D0     		beq	.L4
  49:Core/Src/i2c_error_handler.c ****         i2c_bus_error_count++;
  75              		.loc 1 49 9 is_stmt 1 view .LVU15
  76              		.loc 1 49 28 is_stmt 0 view .LVU16
  77 002e 174A     		ldr	r2, .L13+12
  78 0030 1368     		ldr	r3, [r2]
  79 0032 0133     		adds	r3, r3, #1
  80 0034 1360     		str	r3, [r2]
  81              	.L4:
  50:Core/Src/i2c_error_handler.c ****     }
  51:Core/Src/i2c_error_handler.c ****     if (error & HAL_I2C_ERROR_ARLO) {
  82              		.loc 1 51 5 is_stmt 1 view .LVU17
  83              		.loc 1 51 8 is_stmt 0 view .LVU18
  84 0036 10F0020F 		tst	r0, #2
  85 003a 03D0     		beq	.L5
  52:Core/Src/i2c_error_handler.c ****         i2c_arbitration_lost_count++;
  86              		.loc 1 52 9 is_stmt 1 view .LVU19
  87              		.loc 1 52 35 is_stmt 0 view .LVU20
  88 003c 144A     		ldr	r2, .L13+16
  89 003e 1368     		ldr	r3, [r2]
  90 0040 0133     		adds	r3, r3, #1
  91 0042 1360     		str	r3, [r2]
  92              	.L5:
  53:Core/Src/i2c_error_handler.c ****     }
  54:Core/Src/i2c_error_handler.c **** 
  55:Core/Src/i2c_error_handler.c ****     /* Reset I2C peripheral on critical errors */
  56:Core/Src/i2c_error_handler.c ****     if (error & (HAL_I2C_ERROR_BERR | HAL_I2C_ERROR_ARLO | HAL_I2C_ERROR_TIMEOUT)) {
  93              		.loc 1 56 5 is_stmt 1 view .LVU21
  94              		.loc 1 56 8 is_stmt 0 view .LVU22
  95 0044 10F0230F 		tst	r0, #35
  96 0048 02D1     		bne	.L12
  97              	.LVL2:
  98              	.L6:
  57:Core/Src/i2c_error_handler.c ****         i2c_recovery_count++;
  58:Core/Src/i2c_error_handler.c **** 
  59:Core/Src/i2c_error_handler.c ****         /* Disable I2C peripheral */
  60:Core/Src/i2c_error_handler.c ****         __HAL_I2C_DISABLE(hi2c);
  61:Core/Src/i2c_error_handler.c **** 
  62:Core/Src/i2c_error_handler.c ****         /* Force reset of I2C peripheral */
  63:Core/Src/i2c_error_handler.c ****         __HAL_RCC_I2C1_FORCE_RESET();
  64:Core/Src/i2c_error_handler.c ****         HAL_Delay(2);
  65:Core/Src/i2c_error_handler.c ****         __HAL_RCC_I2C1_RELEASE_RESET();
  66:Core/Src/i2c_error_handler.c **** 
  67:Core/Src/i2c_error_handler.c ****         /* Re-initialize I2C */
  68:Core/Src/i2c_error_handler.c ****         MX_I2C1_Init();
  69:Core/Src/i2c_error_handler.c ****     }
  70:Core/Src/i2c_error_handler.c ****     
  71:Core/Src/i2c_error_handler.c ****     /* 通知DMA管理器状态机停止 */
  72:Core/Src/i2c_error_handler.c ****     I2C_DMA_HandleError();
  99              		.loc 1 72 5 is_stmt 1 view .LVU23
ARM GAS  /tmp/cckYNZki.s 			page 4


 100 004a FFF7FEFF 		bl	I2C_DMA_HandleError
 101              	.LVL3:
  73:Core/Src/i2c_error_handler.c **** }
 102              		.loc 1 73 1 is_stmt 0 view .LVU24
 103 004e 10BD     		pop	{r4, pc}
 104              	.LVL4:
 105              	.L12:
  57:Core/Src/i2c_error_handler.c ****         i2c_recovery_count++;
 106              		.loc 1 57 9 is_stmt 1 view .LVU25
  57:Core/Src/i2c_error_handler.c ****         i2c_recovery_count++;
 107              		.loc 1 57 27 is_stmt 0 view .LVU26
 108 0050 104A     		ldr	r2, .L13+20
 109 0052 1368     		ldr	r3, [r2]
 110 0054 0133     		adds	r3, r3, #1
 111 0056 1360     		str	r3, [r2]
  60:Core/Src/i2c_error_handler.c **** 
 112              		.loc 1 60 9 is_stmt 1 view .LVU27
 113 0058 2268     		ldr	r2, [r4]
 114 005a 1368     		ldr	r3, [r2]
 115 005c 23F00103 		bic	r3, r3, #1
 116 0060 1360     		str	r3, [r2]
  63:Core/Src/i2c_error_handler.c ****         HAL_Delay(2);
 117              		.loc 1 63 9 view .LVU28
 118 0062 0D4C     		ldr	r4, .L13+24
 119              	.LVL5:
  63:Core/Src/i2c_error_handler.c ****         HAL_Delay(2);
 120              		.loc 1 63 9 is_stmt 0 view .LVU29
 121 0064 236A     		ldr	r3, [r4, #32]
 122 0066 43F40013 		orr	r3, r3, #2097152
 123 006a 2362     		str	r3, [r4, #32]
  64:Core/Src/i2c_error_handler.c ****         __HAL_RCC_I2C1_RELEASE_RESET();
 124              		.loc 1 64 9 is_stmt 1 view .LVU30
 125 006c 0220     		movs	r0, #2
 126              	.LVL6:
  64:Core/Src/i2c_error_handler.c ****         __HAL_RCC_I2C1_RELEASE_RESET();
 127              		.loc 1 64 9 is_stmt 0 view .LVU31
 128 006e FFF7FEFF 		bl	HAL_Delay
 129              	.LVL7:
  65:Core/Src/i2c_error_handler.c **** 
 130              		.loc 1 65 9 is_stmt 1 view .LVU32
 131 0072 236A     		ldr	r3, [r4, #32]
 132 0074 23F40013 		bic	r3, r3, #2097152
 133 0078 2362     		str	r3, [r4, #32]
  68:Core/Src/i2c_error_handler.c ****     }
 134              		.loc 1 68 9 view .LVU33
 135 007a FFF7FEFF 		bl	MX_I2C1_Init
 136              	.LVL8:
 137 007e E4E7     		b	.L6
 138              	.L14:
 139              		.align	2
 140              	.L13:
 141 0080 00540040 		.word	1073763328
 142 0084 00000000 		.word	.LANCHOR0
 143 0088 00000000 		.word	.LANCHOR1
 144 008c 00000000 		.word	.LANCHOR2
 145 0090 00000000 		.word	.LANCHOR3
 146 0094 00000000 		.word	.LANCHOR4
ARM GAS  /tmp/cckYNZki.s 			page 5


 147 0098 00380240 		.word	1073887232
 148              		.cfi_endproc
 149              	.LFE134:
 151              		.section	.text.I2C_RecoverBus,"ax",%progbits
 152              		.align	1
 153              		.global	I2C_RecoverBus
 154              		.syntax unified
 155              		.thumb
 156              		.thumb_func
 157              		.fpu fpv4-sp-d16
 159              	I2C_RecoverBus:
 160              	.LFB135:
  74:Core/Src/i2c_error_handler.c **** 
  75:Core/Src/i2c_error_handler.c **** /**
  76:Core/Src/i2c_error_handler.c ****   * @brief  Recovers I2C bus by generating clock pulses to clear stuck slave
  77:Core/Src/i2c_error_handler.c ****   * @note   This function should be called when I2C bus is stuck (SDA/SCL low)
  78:Core/Src/i2c_error_handler.c ****   * @retval HAL_OK if recovery successful, HAL_ERROR otherwise
  79:Core/Src/i2c_error_handler.c ****   */
  80:Core/Src/i2c_error_handler.c **** HAL_StatusTypeDef I2C_RecoverBus(void)
  81:Core/Src/i2c_error_handler.c **** {
 161              		.loc 1 81 1 view -0
 162              		.cfi_startproc
 163              		@ args = 0, pretend = 0, frame = 24
 164              		@ frame_needed = 0, uses_anonymous_args = 0
 165 0000 F0B5     		push	{r4, r5, r6, r7, lr}
 166              	.LCFI1:
 167              		.cfi_def_cfa_offset 20
 168              		.cfi_offset 4, -20
 169              		.cfi_offset 5, -16
 170              		.cfi_offset 6, -12
 171              		.cfi_offset 7, -8
 172              		.cfi_offset 14, -4
 173 0002 87B0     		sub	sp, sp, #28
 174              	.LCFI2:
 175              		.cfi_def_cfa_offset 48
  82:Core/Src/i2c_error_handler.c ****     GPIO_InitTypeDef GPIO_InitStruct = {0};
 176              		.loc 1 82 5 view .LVU35
 177              		.loc 1 82 22 is_stmt 0 view .LVU36
 178 0004 0024     		movs	r4, #0
 179 0006 0194     		str	r4, [sp, #4]
 180 0008 0294     		str	r4, [sp, #8]
 181 000a 0394     		str	r4, [sp, #12]
 182 000c 0494     		str	r4, [sp, #16]
 183 000e 0594     		str	r4, [sp, #20]
  83:Core/Src/i2c_error_handler.c **** 
  84:Core/Src/i2c_error_handler.c ****     /* De-initialize I2C to release pins */
  85:Core/Src/i2c_error_handler.c ****     HAL_I2C_DeInit(&hi2c1);
 184              		.loc 1 85 5 is_stmt 1 view .LVU37
 185 0010 2948     		ldr	r0, .L19
 186 0012 FFF7FEFF 		bl	HAL_I2C_DeInit
 187              	.LVL9:
  86:Core/Src/i2c_error_handler.c **** 
  87:Core/Src/i2c_error_handler.c ****     /* Reconfigure I2C pins as GPIO open-drain output */
  88:Core/Src/i2c_error_handler.c ****     GPIO_InitStruct.Pin = GPIO_PIN_6 | GPIO_PIN_9;  // PB6=SCL, PB9=SDA
 188              		.loc 1 88 5 view .LVU38
 189              		.loc 1 88 25 is_stmt 0 view .LVU39
 190 0016 4FF41073 		mov	r3, #576
ARM GAS  /tmp/cckYNZki.s 			page 6


 191 001a 0193     		str	r3, [sp, #4]
  89:Core/Src/i2c_error_handler.c ****     GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_OD;
 192              		.loc 1 89 5 is_stmt 1 view .LVU40
 193              		.loc 1 89 26 is_stmt 0 view .LVU41
 194 001c 1123     		movs	r3, #17
 195 001e 0293     		str	r3, [sp, #8]
  90:Core/Src/i2c_error_handler.c ****     GPIO_InitStruct.Pull = GPIO_PULLUP;
 196              		.loc 1 90 5 is_stmt 1 view .LVU42
 197              		.loc 1 90 26 is_stmt 0 view .LVU43
 198 0020 0126     		movs	r6, #1
 199 0022 0396     		str	r6, [sp, #12]
  91:Core/Src/i2c_error_handler.c ****     GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_HIGH;
 200              		.loc 1 91 5 is_stmt 1 view .LVU44
 201              		.loc 1 91 27 is_stmt 0 view .LVU45
 202 0024 0227     		movs	r7, #2
 203 0026 0497     		str	r7, [sp, #16]
  92:Core/Src/i2c_error_handler.c ****     HAL_GPIO_Init(GPIOB, &GPIO_InitStruct);
 204              		.loc 1 92 5 is_stmt 1 view .LVU46
 205 0028 244D     		ldr	r5, .L19+4
 206 002a 01A9     		add	r1, sp, #4
 207 002c 2846     		mov	r0, r5
 208 002e FFF7FEFF 		bl	HAL_GPIO_Init
 209              	.LVL10:
  93:Core/Src/i2c_error_handler.c **** 
  94:Core/Src/i2c_error_handler.c ****     /* Ensure both lines are high initially */
  95:Core/Src/i2c_error_handler.c ****     HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);  // SCL high
 210              		.loc 1 95 5 view .LVU47
 211 0032 3246     		mov	r2, r6
 212 0034 4021     		movs	r1, #64
 213 0036 2846     		mov	r0, r5
 214 0038 FFF7FEFF 		bl	HAL_GPIO_WritePin
 215              	.LVL11:
  96:Core/Src/i2c_error_handler.c ****     HAL_GPIO_WritePin(GPIOB, GPIO_PIN_9, GPIO_PIN_SET);  // SDA high
 216              		.loc 1 96 5 view .LVU48
 217 003c 3246     		mov	r2, r6
 218 003e 4FF40071 		mov	r1, #512
 219 0042 2846     		mov	r0, r5
 220 0044 FFF7FEFF 		bl	HAL_GPIO_WritePin
 221              	.LVL12:
  97:Core/Src/i2c_error_handler.c ****     HAL_Delay(2);
 222              		.loc 1 97 5 view .LVU49
 223 0048 3846     		mov	r0, r7
 224 004a FFF7FEFF 		bl	HAL_Delay
 225              	.LVL13:
  98:Core/Src/i2c_error_handler.c **** 
  99:Core/Src/i2c_error_handler.c ****     /* Generate 9 clock pulses on SCL to clear any stuck slave device */
 100:Core/Src/i2c_error_handler.c ****     for (int i = 0; i < 9; i++) {
 226              		.loc 1 100 5 view .LVU50
 227              	.LBB2:
 228              		.loc 1 100 10 view .LVU51
 229              		.loc 1 100 5 is_stmt 0 view .LVU52
 230 004e 11E0     		b	.L16
 231              	.LVL14:
 232              	.L17:
 101:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_RESET);  // SCL low
 233              		.loc 1 101 9 is_stmt 1 discriminator 3 view .LVU53
 234 0050 1A4D     		ldr	r5, .L19+4
ARM GAS  /tmp/cckYNZki.s 			page 7


 235 0052 0022     		movs	r2, #0
 236 0054 4021     		movs	r1, #64
 237 0056 2846     		mov	r0, r5
 238 0058 FFF7FEFF 		bl	HAL_GPIO_WritePin
 239              	.LVL15:
 102:Core/Src/i2c_error_handler.c ****         HAL_Delay(1);
 240              		.loc 1 102 9 discriminator 3 view .LVU54
 241 005c 0120     		movs	r0, #1
 242 005e FFF7FEFF 		bl	HAL_Delay
 243              	.LVL16:
 103:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);    // SCL high
 244              		.loc 1 103 9 discriminator 3 view .LVU55
 245 0062 0122     		movs	r2, #1
 246 0064 4021     		movs	r1, #64
 247 0066 2846     		mov	r0, r5
 248 0068 FFF7FEFF 		bl	HAL_GPIO_WritePin
 249              	.LVL17:
 104:Core/Src/i2c_error_handler.c ****         HAL_Delay(1);
 250              		.loc 1 104 9 discriminator 3 view .LVU56
 251 006c 0120     		movs	r0, #1
 252 006e FFF7FEFF 		bl	HAL_Delay
 253              	.LVL18:
 100:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_RESET);  // SCL low
 254              		.loc 1 100 28 discriminator 3 view .LVU57
 100:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_RESET);  // SCL low
 255              		.loc 1 100 29 is_stmt 0 discriminator 3 view .LVU58
 256 0072 0134     		adds	r4, r4, #1
 257              	.LVL19:
 258              	.L16:
 100:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_RESET);  // SCL low
 259              		.loc 1 100 21 is_stmt 1 discriminator 1 view .LVU59
 100:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_RESET);  // SCL low
 260              		.loc 1 100 5 is_stmt 0 discriminator 1 view .LVU60
 261 0074 082C     		cmp	r4, #8
 262 0076 EBDD     		ble	.L17
 263              	.LBE2:
 105:Core/Src/i2c_error_handler.c ****     }
 106:Core/Src/i2c_error_handler.c **** 
 107:Core/Src/i2c_error_handler.c ****     /* Generate I2C STOP condition */
 108:Core/Src/i2c_error_handler.c ****     /* SDA goes from low to high while SCL is high */
 109:Core/Src/i2c_error_handler.c ****     HAL_GPIO_WritePin(GPIOB, GPIO_PIN_9, GPIO_PIN_RESET);  // SDA low
 264              		.loc 1 109 5 is_stmt 1 view .LVU61
 265 0078 104C     		ldr	r4, .L19+4
 266              	.LVL20:
 267              		.loc 1 109 5 is_stmt 0 view .LVU62
 268 007a 0022     		movs	r2, #0
 269 007c 4FF40071 		mov	r1, #512
 270 0080 2046     		mov	r0, r4
 271 0082 FFF7FEFF 		bl	HAL_GPIO_WritePin
 272              	.LVL21:
 110:Core/Src/i2c_error_handler.c ****     HAL_Delay(1);
 273              		.loc 1 110 5 is_stmt 1 view .LVU63
 274 0086 0120     		movs	r0, #1
 275 0088 FFF7FEFF 		bl	HAL_Delay
 276              	.LVL22:
 111:Core/Src/i2c_error_handler.c ****     HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);    // SCL high
 277              		.loc 1 111 5 view .LVU64
ARM GAS  /tmp/cckYNZki.s 			page 8


 278 008c 0122     		movs	r2, #1
 279 008e 4021     		movs	r1, #64
 280 0090 2046     		mov	r0, r4
 281 0092 FFF7FEFF 		bl	HAL_GPIO_WritePin
 282              	.LVL23:
 112:Core/Src/i2c_error_handler.c ****     HAL_Delay(1);
 283              		.loc 1 112 5 view .LVU65
 284 0096 0120     		movs	r0, #1
 285 0098 FFF7FEFF 		bl	HAL_Delay
 286              	.LVL24:
 113:Core/Src/i2c_error_handler.c ****     HAL_GPIO_WritePin(GPIOB, GPIO_PIN_9, GPIO_PIN_SET);    // SDA high (STOP)
 287              		.loc 1 113 5 view .LVU66
 288 009c 0122     		movs	r2, #1
 289 009e 4FF40071 		mov	r1, #512
 290 00a2 2046     		mov	r0, r4
 291 00a4 FFF7FEFF 		bl	HAL_GPIO_WritePin
 292              	.LVL25:
 114:Core/Src/i2c_error_handler.c ****     HAL_Delay(2);
 293              		.loc 1 114 5 view .LVU67
 294 00a8 0220     		movs	r0, #2
 295 00aa FFF7FEFF 		bl	HAL_Delay
 296              	.LVL26:
 115:Core/Src/i2c_error_handler.c **** 
 116:Core/Src/i2c_error_handler.c ****     /* Re-initialize I2C peripheral */
 117:Core/Src/i2c_error_handler.c ****     MX_I2C1_Init();
 297              		.loc 1 117 5 view .LVU68
 298 00ae FFF7FEFF 		bl	MX_I2C1_Init
 299              	.LVL27:
 118:Core/Src/i2c_error_handler.c ****     return HAL_OK;
 300              		.loc 1 118 5 view .LVU69
 119:Core/Src/i2c_error_handler.c **** }
 301              		.loc 1 119 1 is_stmt 0 view .LVU70
 302 00b2 0020     		movs	r0, #0
 303 00b4 07B0     		add	sp, sp, #28
 304              	.LCFI3:
 305              		.cfi_def_cfa_offset 20
 306              		@ sp needed
 307 00b6 F0BD     		pop	{r4, r5, r6, r7, pc}
 308              	.L20:
 309              		.align	2
 310              	.L19:
 311 00b8 00000000 		.word	hi2c1
 312 00bc 00040240 		.word	1073873920
 313              		.cfi_endproc
 314              	.LFE135:
 316              		.section	.text.I2C_GetErrorStats,"ax",%progbits
 317              		.align	1
 318              		.global	I2C_GetErrorStats
 319              		.syntax unified
 320              		.thumb
 321              		.thumb_func
 322              		.fpu fpv4-sp-d16
 324              	I2C_GetErrorStats:
 325              	.LVL28:
 326              	.LFB136:
 120:Core/Src/i2c_error_handler.c **** 
 121:Core/Src/i2c_error_handler.c **** /**
ARM GAS  /tmp/cckYNZki.s 			page 9


 122:Core/Src/i2c_error_handler.c ****   * @brief  Gets I2C error statistics
 123:Core/Src/i2c_error_handler.c ****   * @param  total_errors Total error count
 124:Core/Src/i2c_error_handler.c ****   * @param  timeouts Timeout error count
 125:Core/Src/i2c_error_handler.c ****   * @param  bus_errors Bus error count
 126:Core/Src/i2c_error_handler.c ****   * @param  recoveries Recovery attempt count
 127:Core/Src/i2c_error_handler.c ****   * @retval None
 128:Core/Src/i2c_error_handler.c ****   */
 129:Core/Src/i2c_error_handler.c **** void I2C_GetErrorStats(uint32_t *total_errors, uint32_t *timeouts,
 130:Core/Src/i2c_error_handler.c ****                        uint32_t *bus_errors, uint32_t *recoveries)
 131:Core/Src/i2c_error_handler.c **** {
 327              		.loc 1 131 1 is_stmt 1 view -0
 328              		.cfi_startproc
 329              		@ args = 0, pretend = 0, frame = 0
 330              		@ frame_needed = 0, uses_anonymous_args = 0
 331              		@ link register save eliminated.
 132:Core/Src/i2c_error_handler.c ****     if (total_errors) *total_errors = i2c_error_count;
 332              		.loc 1 132 5 view .LVU72
 333              		.loc 1 132 8 is_stmt 0 view .LVU73
 334 0000 98B1     		cbz	r0, .L27
 131:Core/Src/i2c_error_handler.c ****     if (total_errors) *total_errors = i2c_error_count;
 335              		.loc 1 131 1 discriminator 1 view .LVU74
 336 0002 10B4     		push	{r4}
 337              	.LCFI4:
 338              		.cfi_def_cfa_offset 4
 339              		.cfi_offset 4, -4
 340 0004 0446     		mov	r4, r0
 341              		.loc 1 132 23 is_stmt 1 discriminator 1 view .LVU75
 342              		.loc 1 132 37 is_stmt 0 discriminator 1 view .LVU76
 343 0006 1048     		ldr	r0, .L36
 344              	.LVL29:
 345              		.loc 1 132 37 discriminator 1 view .LVU77
 346 0008 0068     		ldr	r0, [r0]
 347 000a 2060     		str	r0, [r4]
 133:Core/Src/i2c_error_handler.c ****     if (timeouts) *timeouts = i2c_timeout_count;
 348              		.loc 1 133 5 is_stmt 1 discriminator 1 view .LVU78
 349              		.loc 1 133 8 is_stmt 0 discriminator 1 view .LVU79
 350 000c 11B1     		cbz	r1, .L23
 351              		.loc 1 133 19 is_stmt 1 discriminator 1 view .LVU80
 352              		.loc 1 133 29 is_stmt 0 discriminator 1 view .LVU81
 353 000e 0F48     		ldr	r0, .L36+4
 354 0010 0068     		ldr	r0, [r0]
 355 0012 0860     		str	r0, [r1]
 356              	.L23:
 134:Core/Src/i2c_error_handler.c ****     if (bus_errors) *bus_errors = i2c_bus_error_count;
 357              		.loc 1 134 5 is_stmt 1 view .LVU82
 358              		.loc 1 134 8 is_stmt 0 view .LVU83
 359 0014 12B1     		cbz	r2, .L24
 360              		.loc 1 134 21 is_stmt 1 discriminator 1 view .LVU84
 361              		.loc 1 134 33 is_stmt 0 discriminator 1 view .LVU85
 362 0016 0E49     		ldr	r1, .L36+8
 363              	.LVL30:
 364              		.loc 1 134 33 discriminator 1 view .LVU86
 365 0018 0968     		ldr	r1, [r1]
 366 001a 1160     		str	r1, [r2]
 367              	.L24:
 135:Core/Src/i2c_error_handler.c ****     if (recoveries) *recoveries = i2c_recovery_count;
 368              		.loc 1 135 5 is_stmt 1 view .LVU87
ARM GAS  /tmp/cckYNZki.s 			page 10


 369              		.loc 1 135 8 is_stmt 0 view .LVU88
 370 001c 13B1     		cbz	r3, .L21
 371              		.loc 1 135 21 is_stmt 1 discriminator 1 view .LVU89
 372              		.loc 1 135 33 is_stmt 0 discriminator 1 view .LVU90
 373 001e 0D4A     		ldr	r2, .L36+12
 374              	.LVL31:
 375              		.loc 1 135 33 discriminator 1 view .LVU91
 376 0020 1268     		ldr	r2, [r2]
 377 0022 1A60     		str	r2, [r3]
 378              	.L21:
 136:Core/Src/i2c_error_handler.c **** }
 379              		.loc 1 136 1 view .LVU92
 380 0024 5DF8044B 		ldr	r4, [sp], #4
 381              	.LCFI5:
 382              		.cfi_restore 4
 383              		.cfi_def_cfa_offset 0
 384              	.LVL32:
 385              		.loc 1 136 1 view .LVU93
 386 0028 7047     		bx	lr
 387              	.LVL33:
 388              	.L27:
 133:Core/Src/i2c_error_handler.c ****     if (bus_errors) *bus_errors = i2c_bus_error_count;
 389              		.loc 1 133 5 is_stmt 1 view .LVU94
 133:Core/Src/i2c_error_handler.c ****     if (bus_errors) *bus_errors = i2c_bus_error_count;
 390              		.loc 1 133 8 is_stmt 0 view .LVU95
 391 002a 11B1     		cbz	r1, .L29
 133:Core/Src/i2c_error_handler.c ****     if (bus_errors) *bus_errors = i2c_bus_error_count;
 392              		.loc 1 133 19 is_stmt 1 view .LVU96
 133:Core/Src/i2c_error_handler.c ****     if (bus_errors) *bus_errors = i2c_bus_error_count;
 393              		.loc 1 133 29 is_stmt 0 view .LVU97
 394 002c 0748     		ldr	r0, .L36+4
 395              	.LVL34:
 133:Core/Src/i2c_error_handler.c ****     if (bus_errors) *bus_errors = i2c_bus_error_count;
 396              		.loc 1 133 29 view .LVU98
 397 002e 0068     		ldr	r0, [r0]
 398 0030 0860     		str	r0, [r1]
 399              	.L29:
 134:Core/Src/i2c_error_handler.c ****     if (recoveries) *recoveries = i2c_recovery_count;
 400              		.loc 1 134 5 is_stmt 1 view .LVU99
 134:Core/Src/i2c_error_handler.c ****     if (recoveries) *recoveries = i2c_recovery_count;
 401              		.loc 1 134 8 is_stmt 0 view .LVU100
 402 0032 12B1     		cbz	r2, .L31
 134:Core/Src/i2c_error_handler.c ****     if (recoveries) *recoveries = i2c_recovery_count;
 403              		.loc 1 134 21 is_stmt 1 view .LVU101
 134:Core/Src/i2c_error_handler.c ****     if (recoveries) *recoveries = i2c_recovery_count;
 404              		.loc 1 134 33 is_stmt 0 view .LVU102
 405 0034 0649     		ldr	r1, .L36+8
 406              	.LVL35:
 134:Core/Src/i2c_error_handler.c ****     if (recoveries) *recoveries = i2c_recovery_count;
 407              		.loc 1 134 33 view .LVU103
 408 0036 0968     		ldr	r1, [r1]
 409 0038 1160     		str	r1, [r2]
 410              	.L31:
 135:Core/Src/i2c_error_handler.c **** }
 411              		.loc 1 135 5 is_stmt 1 view .LVU104
 135:Core/Src/i2c_error_handler.c **** }
 412              		.loc 1 135 8 is_stmt 0 view .LVU105
ARM GAS  /tmp/cckYNZki.s 			page 11


 413 003a 1BB1     		cbz	r3, .L33
 135:Core/Src/i2c_error_handler.c **** }
 414              		.loc 1 135 21 is_stmt 1 view .LVU106
 135:Core/Src/i2c_error_handler.c **** }
 415              		.loc 1 135 33 is_stmt 0 view .LVU107
 416 003c 054A     		ldr	r2, .L36+12
 417              	.LVL36:
 135:Core/Src/i2c_error_handler.c **** }
 418              		.loc 1 135 33 view .LVU108
 419 003e 1268     		ldr	r2, [r2]
 420 0040 1A60     		str	r2, [r3]
 421 0042 7047     		bx	lr
 422              	.LVL37:
 423              	.L33:
 135:Core/Src/i2c_error_handler.c **** }
 424              		.loc 1 135 33 view .LVU109
 425 0044 7047     		bx	lr
 426              	.L37:
 427 0046 00BF     		.align	2
 428              	.L36:
 429 0048 00000000 		.word	.LANCHOR0
 430 004c 00000000 		.word	.LANCHOR1
 431 0050 00000000 		.word	.LANCHOR2
 432 0054 00000000 		.word	.LANCHOR4
 433              		.cfi_endproc
 434              	.LFE136:
 436              		.section	.text.I2C_ResetErrorStats,"ax",%progbits
 437              		.align	1
 438              		.global	I2C_ResetErrorStats
 439              		.syntax unified
 440              		.thumb
 441              		.thumb_func
 442              		.fpu fpv4-sp-d16
 444              	I2C_ResetErrorStats:
 445              	.LFB137:
 137:Core/Src/i2c_error_handler.c **** 
 138:Core/Src/i2c_error_handler.c **** /**
 139:Core/Src/i2c_error_handler.c ****   * @brief  Resets I2C error statistics
 140:Core/Src/i2c_error_handler.c ****   * @retval None
 141:Core/Src/i2c_error_handler.c ****   */
 142:Core/Src/i2c_error_handler.c **** void I2C_ResetErrorStats(void)
 143:Core/Src/i2c_error_handler.c **** {
 446              		.loc 1 143 1 is_stmt 1 view -0
 447              		.cfi_startproc
 448              		@ args = 0, pretend = 0, frame = 0
 449              		@ frame_needed = 0, uses_anonymous_args = 0
 450              		@ link register save eliminated.
 144:Core/Src/i2c_error_handler.c ****     i2c_error_count = 0;
 451              		.loc 1 144 5 view .LVU111
 452              		.loc 1 144 21 is_stmt 0 view .LVU112
 453 0000 0023     		movs	r3, #0
 454 0002 064A     		ldr	r2, .L39
 455 0004 1360     		str	r3, [r2]
 145:Core/Src/i2c_error_handler.c ****     i2c_timeout_count = 0;
 456              		.loc 1 145 5 is_stmt 1 view .LVU113
 457              		.loc 1 145 23 is_stmt 0 view .LVU114
 458 0006 064A     		ldr	r2, .L39+4
ARM GAS  /tmp/cckYNZki.s 			page 12


 459 0008 1360     		str	r3, [r2]
 146:Core/Src/i2c_error_handler.c ****     i2c_bus_error_count = 0;
 460              		.loc 1 146 5 is_stmt 1 view .LVU115
 461              		.loc 1 146 25 is_stmt 0 view .LVU116
 462 000a 064A     		ldr	r2, .L39+8
 463 000c 1360     		str	r3, [r2]
 147:Core/Src/i2c_error_handler.c ****     i2c_arbitration_lost_count = 0;
 464              		.loc 1 147 5 is_stmt 1 view .LVU117
 465              		.loc 1 147 32 is_stmt 0 view .LVU118
 466 000e 064A     		ldr	r2, .L39+12
 467 0010 1360     		str	r3, [r2]
 148:Core/Src/i2c_error_handler.c ****     i2c_recovery_count = 0;
 468              		.loc 1 148 5 is_stmt 1 view .LVU119
 469              		.loc 1 148 24 is_stmt 0 view .LVU120
 470 0012 064A     		ldr	r2, .L39+16
 471 0014 1360     		str	r3, [r2]
 149:Core/Src/i2c_error_handler.c ****     i2c_consecutive_failures = 0;
 472              		.loc 1 149 5 is_stmt 1 view .LVU121
 473              		.loc 1 149 30 is_stmt 0 view .LVU122
 474 0016 064A     		ldr	r2, .L39+20
 475 0018 1360     		str	r3, [r2]
 150:Core/Src/i2c_error_handler.c **** }
 476              		.loc 1 150 1 view .LVU123
 477 001a 7047     		bx	lr
 478              	.L40:
 479              		.align	2
 480              	.L39:
 481 001c 00000000 		.word	.LANCHOR0
 482 0020 00000000 		.word	.LANCHOR1
 483 0024 00000000 		.word	.LANCHOR2
 484 0028 00000000 		.word	.LANCHOR3
 485 002c 00000000 		.word	.LANCHOR4
 486 0030 00000000 		.word	.LANCHOR5
 487              		.cfi_endproc
 488              	.LFE137:
 490              		.section	.text.I2C_ClearBusyFlag,"ax",%progbits
 491              		.align	1
 492              		.global	I2C_ClearBusyFlag
 493              		.syntax unified
 494              		.thumb
 495              		.thumb_func
 496              		.fpu fpv4-sp-d16
 498              	I2C_ClearBusyFlag:
 499              	.LFB138:
 151:Core/Src/i2c_error_handler.c **** 
 152:Core/Src/i2c_error_handler.c **** /**
 153:Core/Src/i2c_error_handler.c ****   * @brief  Clears the BUSY flag if stuck (known STM32 I2C HAL bug workaround)
 154:Core/Src/i2c_error_handler.c ****   * @retval None
 155:Core/Src/i2c_error_handler.c ****   */
 156:Core/Src/i2c_error_handler.c **** void I2C_ClearBusyFlag(void)
 157:Core/Src/i2c_error_handler.c **** {
 500              		.loc 1 157 1 is_stmt 1 view -0
 501              		.cfi_startproc
 502              		@ args = 0, pretend = 0, frame = 8
 503              		@ frame_needed = 0, uses_anonymous_args = 0
 504              		@ link register save eliminated.
 158:Core/Src/i2c_error_handler.c ****     /* Force clear BUSY flag by toggling PE bit */
ARM GAS  /tmp/cckYNZki.s 			page 13


 159:Core/Src/i2c_error_handler.c ****     if (hi2c1.Instance->SR2 & I2C_SR2_BUSY) {
 505              		.loc 1 159 5 view .LVU125
 506              		.loc 1 159 14 is_stmt 0 view .LVU126
 507 0000 0E4B     		ldr	r3, .L50
 508 0002 1B68     		ldr	r3, [r3]
 509              		.loc 1 159 23 view .LVU127
 510 0004 9A69     		ldr	r2, [r3, #24]
 511              		.loc 1 159 8 view .LVU128
 512 0006 12F0020F 		tst	r2, #2
 513 000a 15D0     		beq	.L46
 157:Core/Src/i2c_error_handler.c ****     /* Force clear BUSY flag by toggling PE bit */
 514              		.loc 1 157 1 view .LVU129
 515 000c 82B0     		sub	sp, sp, #8
 516              	.LCFI6:
 517              		.cfi_def_cfa_offset 8
 160:Core/Src/i2c_error_handler.c ****         /* Disable peripheral */
 161:Core/Src/i2c_error_handler.c ****         hi2c1.Instance->CR1 &= ~I2C_CR1_PE;
 518              		.loc 1 161 9 is_stmt 1 view .LVU130
 519              		.loc 1 161 29 is_stmt 0 view .LVU131
 520 000e 1A68     		ldr	r2, [r3]
 521 0010 22F00102 		bic	r2, r2, #1
 522 0014 1A60     		str	r2, [r3]
 162:Core/Src/i2c_error_handler.c ****         
 163:Core/Src/i2c_error_handler.c ****         /* Small delay */
 164:Core/Src/i2c_error_handler.c ****         for (volatile int i = 0; i < 100; i++);
 523              		.loc 1 164 9 is_stmt 1 view .LVU132
 524              	.LBB3:
 525              		.loc 1 164 14 view .LVU133
 526              		.loc 1 164 27 is_stmt 0 view .LVU134
 527 0016 0023     		movs	r3, #0
 528 0018 0193     		str	r3, [sp, #4]
 529              	.L43:
 530              		.loc 1 164 34 is_stmt 1 discriminator 1 view .LVU135
 531              		.loc 1 164 36 is_stmt 0 discriminator 1 view .LVU136
 532 001a 019B     		ldr	r3, [sp, #4]
 533              		.loc 1 164 9 discriminator 1 view .LVU137
 534 001c 632B     		cmp	r3, #99
 535 001e 03DC     		bgt	.L49
 536              		.loc 1 164 47 is_stmt 1 discriminator 3 view .LVU138
 537              		.loc 1 164 43 discriminator 3 view .LVU139
 538              		.loc 1 164 44 is_stmt 0 discriminator 3 view .LVU140
 539 0020 019B     		ldr	r3, [sp, #4]
 540 0022 0133     		adds	r3, r3, #1
 541 0024 0193     		str	r3, [sp, #4]
 542 0026 F8E7     		b	.L43
 543              	.L49:
 544              	.LBE3:
 165:Core/Src/i2c_error_handler.c ****         
 166:Core/Src/i2c_error_handler.c ****         /* Re-enable peripheral */
 167:Core/Src/i2c_error_handler.c ****         hi2c1.Instance->CR1 |= I2C_CR1_PE;
 545              		.loc 1 167 9 is_stmt 1 view .LVU141
 546              		.loc 1 167 14 is_stmt 0 view .LVU142
 547 0028 044B     		ldr	r3, .L50
 548 002a 1A68     		ldr	r2, [r3]
 549              		.loc 1 167 29 view .LVU143
 550 002c 1368     		ldr	r3, [r2]
 551 002e 43F00103 		orr	r3, r3, #1
ARM GAS  /tmp/cckYNZki.s 			page 14


 552 0032 1360     		str	r3, [r2]
 168:Core/Src/i2c_error_handler.c ****     }
 169:Core/Src/i2c_error_handler.c **** }
 553              		.loc 1 169 1 view .LVU144
 554 0034 02B0     		add	sp, sp, #8
 555              	.LCFI7:
 556              		.cfi_def_cfa_offset 0
 557              		@ sp needed
 558 0036 7047     		bx	lr
 559              	.L46:
 560 0038 7047     		bx	lr
 561              	.L51:
 562 003a 00BF     		.align	2
 563              	.L50:
 564 003c 00000000 		.word	hi2c1
 565              		.cfi_endproc
 566              	.LFE138:
 568              		.section	.text.I2C_ForceReset,"ax",%progbits
 569              		.align	1
 570              		.global	I2C_ForceReset
 571              		.syntax unified
 572              		.thumb
 573              		.thumb_func
 574              		.fpu fpv4-sp-d16
 576              	I2C_ForceReset:
 577              	.LFB139:
 170:Core/Src/i2c_error_handler.c **** 
 171:Core/Src/i2c_error_handler.c **** /**
 172:Core/Src/i2c_error_handler.c ****   * @brief  Forces a complete I2C reset (more aggressive than error callback)
 173:Core/Src/i2c_error_handler.c ****   * @retval HAL_OK if successful
 174:Core/Src/i2c_error_handler.c ****   */
 175:Core/Src/i2c_error_handler.c **** HAL_StatusTypeDef I2C_ForceReset(void)
 176:Core/Src/i2c_error_handler.c **** {
 578              		.loc 1 176 1 is_stmt 1 view -0
 579              		.cfi_startproc
 580              		@ args = 0, pretend = 0, frame = 40
 581              		@ frame_needed = 0, uses_anonymous_args = 0
 582 0000 10B5     		push	{r4, lr}
 583              	.LCFI8:
 584              		.cfi_def_cfa_offset 8
 585              		.cfi_offset 4, -8
 586              		.cfi_offset 14, -4
 587 0002 8AB0     		sub	sp, sp, #40
 588              	.LCFI9:
 589              		.cfi_def_cfa_offset 48
 177:Core/Src/i2c_error_handler.c ****     i2c_recovery_count++;
 590              		.loc 1 177 5 view .LVU146
 591              		.loc 1 177 23 is_stmt 0 view .LVU147
 592 0004 454A     		ldr	r2, .L71
 593 0006 1368     		ldr	r3, [r2]
 594 0008 0133     		adds	r3, r3, #1
 595 000a 1360     		str	r3, [r2]
 178:Core/Src/i2c_error_handler.c ****     
 179:Core/Src/i2c_error_handler.c ****     /* Disable I2C peripheral */
 180:Core/Src/i2c_error_handler.c ****     __HAL_I2C_DISABLE(&hi2c1);
 596              		.loc 1 180 5 is_stmt 1 view .LVU148
 597 000c 444B     		ldr	r3, .L71+4
ARM GAS  /tmp/cckYNZki.s 			page 15


 598 000e 1A68     		ldr	r2, [r3]
 599 0010 1368     		ldr	r3, [r2]
 600 0012 23F00103 		bic	r3, r3, #1
 601 0016 1360     		str	r3, [r2]
 181:Core/Src/i2c_error_handler.c ****     
 182:Core/Src/i2c_error_handler.c ****     /* Force GPIO reset to clear any bus lock */
 183:Core/Src/i2c_error_handler.c ****     GPIO_InitTypeDef GPIO_InitStruct = {0};
 602              		.loc 1 183 5 view .LVU149
 603              		.loc 1 183 22 is_stmt 0 view .LVU150
 604 0018 0024     		movs	r4, #0
 605 001a 0994     		str	r4, [sp, #36]
 184:Core/Src/i2c_error_handler.c ****     GPIO_InitStruct.Pin = GPIO_PIN_6 | GPIO_PIN_9;  // SCL, SDA
 606              		.loc 1 184 5 is_stmt 1 view .LVU151
 607              		.loc 1 184 25 is_stmt 0 view .LVU152
 608 001c 4FF41073 		mov	r3, #576
 609 0020 0593     		str	r3, [sp, #20]
 185:Core/Src/i2c_error_handler.c ****     GPIO_InitStruct.Mode = GPIO_MODE_OUTPUT_OD;
 610              		.loc 1 185 5 is_stmt 1 view .LVU153
 611              		.loc 1 185 26 is_stmt 0 view .LVU154
 612 0022 1123     		movs	r3, #17
 613 0024 0693     		str	r3, [sp, #24]
 186:Core/Src/i2c_error_handler.c ****     GPIO_InitStruct.Pull = GPIO_PULLUP;
 614              		.loc 1 186 5 is_stmt 1 view .LVU155
 615              		.loc 1 186 26 is_stmt 0 view .LVU156
 616 0026 0123     		movs	r3, #1
 617 0028 0793     		str	r3, [sp, #28]
 187:Core/Src/i2c_error_handler.c ****     GPIO_InitStruct.Speed = GPIO_SPEED_FREQ_HIGH;
 618              		.loc 1 187 5 is_stmt 1 view .LVU157
 619              		.loc 1 187 27 is_stmt 0 view .LVU158
 620 002a 0223     		movs	r3, #2
 621 002c 0893     		str	r3, [sp, #32]
 188:Core/Src/i2c_error_handler.c ****     HAL_GPIO_Init(GPIOB, &GPIO_InitStruct);
 622              		.loc 1 188 5 is_stmt 1 view .LVU159
 623 002e 05A9     		add	r1, sp, #20
 624 0030 3C48     		ldr	r0, .L71+8
 625 0032 FFF7FEFF 		bl	HAL_GPIO_Init
 626              	.LVL38:
 189:Core/Src/i2c_error_handler.c ****     
 190:Core/Src/i2c_error_handler.c ****     /* Generate 16 clock pulses (more than standard 9) */
 191:Core/Src/i2c_error_handler.c ****     for (int i = 0; i < 16; i++) {
 627              		.loc 1 191 5 view .LVU160
 628              	.LBB4:
 629              		.loc 1 191 10 view .LVU161
 630              		.loc 1 191 5 is_stmt 0 view .LVU162
 631 0036 0EE0     		b	.L53
 632              	.LVL39:
 633              	.L69:
 192:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_RESET);
 193:Core/Src/i2c_error_handler.c ****         for (volatile int d = 0; d < 100; d++);
 194:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);
 634              		.loc 1 194 9 is_stmt 1 view .LVU163
 635 0038 0122     		movs	r2, #1
 636 003a 4021     		movs	r1, #64
 637 003c 3948     		ldr	r0, .L71+8
 638 003e FFF7FEFF 		bl	HAL_GPIO_WritePin
 639              	.LVL40:
 195:Core/Src/i2c_error_handler.c ****         for (volatile int d = 0; d < 100; d++);
ARM GAS  /tmp/cckYNZki.s 			page 16


 640              		.loc 1 195 9 view .LVU164
 641              	.LBB5:
 642              		.loc 1 195 14 view .LVU165
 643              		.loc 1 195 27 is_stmt 0 view .LVU166
 644 0042 0023     		movs	r3, #0
 645 0044 0193     		str	r3, [sp, #4]
 646              		.loc 1 195 9 view .LVU167
 647 0046 02E0     		b	.L56
 648              	.L57:
 649              		.loc 1 195 47 is_stmt 1 discriminator 3 view .LVU168
 650              		.loc 1 195 43 discriminator 3 view .LVU169
 651              		.loc 1 195 44 is_stmt 0 discriminator 3 view .LVU170
 652 0048 019B     		ldr	r3, [sp, #4]
 653 004a 0133     		adds	r3, r3, #1
 654 004c 0193     		str	r3, [sp, #4]
 655              	.L56:
 656              		.loc 1 195 34 is_stmt 1 discriminator 1 view .LVU171
 657              		.loc 1 195 36 is_stmt 0 discriminator 1 view .LVU172
 658 004e 019B     		ldr	r3, [sp, #4]
 659              		.loc 1 195 9 discriminator 1 view .LVU173
 660 0050 632B     		cmp	r3, #99
 661 0052 F9DD     		ble	.L57
 662              	.LBE5:
 191:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_RESET);
 663              		.loc 1 191 29 is_stmt 1 discriminator 2 view .LVU174
 191:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_RESET);
 664              		.loc 1 191 30 is_stmt 0 discriminator 2 view .LVU175
 665 0054 0134     		adds	r4, r4, #1
 666              	.LVL41:
 667              	.L53:
 191:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_RESET);
 668              		.loc 1 191 21 is_stmt 1 discriminator 1 view .LVU176
 191:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_RESET);
 669              		.loc 1 191 5 is_stmt 0 discriminator 1 view .LVU177
 670 0056 0F2C     		cmp	r4, #15
 671 0058 0DDC     		bgt	.L68
 192:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_RESET);
 672              		.loc 1 192 9 is_stmt 1 view .LVU178
 673 005a 0022     		movs	r2, #0
 674 005c 4021     		movs	r1, #64
 675 005e 3148     		ldr	r0, .L71+8
 676 0060 FFF7FEFF 		bl	HAL_GPIO_WritePin
 677              	.LVL42:
 193:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);
 678              		.loc 1 193 9 view .LVU179
 679              	.LBB6:
 193:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);
 680              		.loc 1 193 14 view .LVU180
 193:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);
 681              		.loc 1 193 27 is_stmt 0 view .LVU181
 682 0064 0023     		movs	r3, #0
 683 0066 0093     		str	r3, [sp]
 684              	.L54:
 193:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);
 685              		.loc 1 193 34 is_stmt 1 discriminator 1 view .LVU182
 193:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);
 686              		.loc 1 193 36 is_stmt 0 discriminator 1 view .LVU183
ARM GAS  /tmp/cckYNZki.s 			page 17


 687 0068 009B     		ldr	r3, [sp]
 193:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);
 688              		.loc 1 193 9 discriminator 1 view .LVU184
 689 006a 632B     		cmp	r3, #99
 690 006c E4DC     		bgt	.L69
 193:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);
 691              		.loc 1 193 47 is_stmt 1 discriminator 3 view .LVU185
 193:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);
 692              		.loc 1 193 43 discriminator 3 view .LVU186
 193:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);
 693              		.loc 1 193 44 is_stmt 0 discriminator 3 view .LVU187
 694 006e 009B     		ldr	r3, [sp]
 695 0070 0133     		adds	r3, r3, #1
 696 0072 0093     		str	r3, [sp]
 697 0074 F8E7     		b	.L54
 698              	.L68:
 699              	.LBE6:
 700              	.LBE4:
 701              	.LBB7:
 196:Core/Src/i2c_error_handler.c ****     }
 197:Core/Src/i2c_error_handler.c ****     
 198:Core/Src/i2c_error_handler.c ****     /* Generate multiple STOP conditions to clear any partial transaction */
 199:Core/Src/i2c_error_handler.c ****     for (int i = 0; i < 3; i++) {
 702              		.loc 1 199 14 view .LVU188
 703 0076 0024     		movs	r4, #0
 704              	.LVL43:
 705              		.loc 1 199 14 view .LVU189
 706 0078 23E0     		b	.L59
 707              	.LVL44:
 708              	.L61:
 709              	.LBB8:
 200:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_9, GPIO_PIN_RESET);  // SDA low
 201:Core/Src/i2c_error_handler.c ****         for (volatile int d = 0; d < 50; d++);
 710              		.loc 1 201 46 is_stmt 1 discriminator 3 view .LVU190
 711              		.loc 1 201 42 discriminator 3 view .LVU191
 712              		.loc 1 201 43 is_stmt 0 discriminator 3 view .LVU192
 713 007a 029B     		ldr	r3, [sp, #8]
 714 007c 0133     		adds	r3, r3, #1
 715 007e 0293     		str	r3, [sp, #8]
 716              	.L60:
 717              		.loc 1 201 34 is_stmt 1 discriminator 1 view .LVU193
 718              		.loc 1 201 36 is_stmt 0 discriminator 1 view .LVU194
 719 0080 029B     		ldr	r3, [sp, #8]
 720              		.loc 1 201 9 discriminator 1 view .LVU195
 721 0082 312B     		cmp	r3, #49
 722 0084 F9DD     		ble	.L61
 723              	.LBE8:
 202:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);    // SCL high
 724              		.loc 1 202 9 is_stmt 1 view .LVU196
 725 0086 0122     		movs	r2, #1
 726 0088 4021     		movs	r1, #64
 727 008a 2648     		ldr	r0, .L71+8
 728 008c FFF7FEFF 		bl	HAL_GPIO_WritePin
 729              	.LVL45:
 203:Core/Src/i2c_error_handler.c ****         for (volatile int d = 0; d < 50; d++);
 730              		.loc 1 203 9 view .LVU197
 731              	.LBB9:
ARM GAS  /tmp/cckYNZki.s 			page 18


 732              		.loc 1 203 14 view .LVU198
 733              		.loc 1 203 27 is_stmt 0 view .LVU199
 734 0090 0023     		movs	r3, #0
 735 0092 0393     		str	r3, [sp, #12]
 736              		.loc 1 203 9 view .LVU200
 737 0094 02E0     		b	.L62
 738              	.L63:
 739              		.loc 1 203 46 is_stmt 1 discriminator 3 view .LVU201
 740              		.loc 1 203 42 discriminator 3 view .LVU202
 741              		.loc 1 203 43 is_stmt 0 discriminator 3 view .LVU203
 742 0096 039B     		ldr	r3, [sp, #12]
 743 0098 0133     		adds	r3, r3, #1
 744 009a 0393     		str	r3, [sp, #12]
 745              	.L62:
 746              		.loc 1 203 34 is_stmt 1 discriminator 1 view .LVU204
 747              		.loc 1 203 36 is_stmt 0 discriminator 1 view .LVU205
 748 009c 039B     		ldr	r3, [sp, #12]
 749              		.loc 1 203 9 discriminator 1 view .LVU206
 750 009e 312B     		cmp	r3, #49
 751 00a0 F9DD     		ble	.L63
 752              	.LBE9:
 204:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_9, GPIO_PIN_SET);    // SDA high (STOP)
 753              		.loc 1 204 9 is_stmt 1 view .LVU207
 754 00a2 0122     		movs	r2, #1
 755 00a4 4FF40071 		mov	r1, #512
 756 00a8 1E48     		ldr	r0, .L71+8
 757 00aa FFF7FEFF 		bl	HAL_GPIO_WritePin
 758              	.LVL46:
 205:Core/Src/i2c_error_handler.c ****         for (volatile int d = 0; d < 100; d++);
 759              		.loc 1 205 9 view .LVU208
 760              	.LBB10:
 761              		.loc 1 205 14 view .LVU209
 762              		.loc 1 205 27 is_stmt 0 view .LVU210
 763 00ae 0023     		movs	r3, #0
 764 00b0 0493     		str	r3, [sp, #16]
 765              		.loc 1 205 9 view .LVU211
 766 00b2 02E0     		b	.L64
 767              	.L65:
 768              		.loc 1 205 47 is_stmt 1 discriminator 3 view .LVU212
 769              		.loc 1 205 43 discriminator 3 view .LVU213
 770              		.loc 1 205 44 is_stmt 0 discriminator 3 view .LVU214
 771 00b4 049B     		ldr	r3, [sp, #16]
 772 00b6 0133     		adds	r3, r3, #1
 773 00b8 0493     		str	r3, [sp, #16]
 774              	.L64:
 775              		.loc 1 205 34 is_stmt 1 discriminator 1 view .LVU215
 776              		.loc 1 205 36 is_stmt 0 discriminator 1 view .LVU216
 777 00ba 049B     		ldr	r3, [sp, #16]
 778              		.loc 1 205 9 discriminator 1 view .LVU217
 779 00bc 632B     		cmp	r3, #99
 780 00be F9DD     		ble	.L65
 781              	.LBE10:
 199:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_9, GPIO_PIN_RESET);  // SDA low
 782              		.loc 1 199 28 is_stmt 1 discriminator 2 view .LVU218
 199:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_9, GPIO_PIN_RESET);  // SDA low
 783              		.loc 1 199 29 is_stmt 0 discriminator 2 view .LVU219
 784 00c0 0134     		adds	r4, r4, #1
ARM GAS  /tmp/cckYNZki.s 			page 19


 785              	.LVL47:
 786              	.L59:
 199:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_9, GPIO_PIN_RESET);  // SDA low
 787              		.loc 1 199 21 is_stmt 1 discriminator 1 view .LVU220
 199:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_9, GPIO_PIN_RESET);  // SDA low
 788              		.loc 1 199 5 is_stmt 0 discriminator 1 view .LVU221
 789 00c2 022C     		cmp	r4, #2
 790 00c4 08DC     		bgt	.L70
 200:Core/Src/i2c_error_handler.c ****         for (volatile int d = 0; d < 50; d++);
 791              		.loc 1 200 9 is_stmt 1 view .LVU222
 792 00c6 0022     		movs	r2, #0
 793 00c8 4FF40071 		mov	r1, #512
 794 00cc 1548     		ldr	r0, .L71+8
 795 00ce FFF7FEFF 		bl	HAL_GPIO_WritePin
 796              	.LVL48:
 201:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);    // SCL high
 797              		.loc 1 201 9 view .LVU223
 798              	.LBB11:
 201:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);    // SCL high
 799              		.loc 1 201 14 view .LVU224
 201:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);    // SCL high
 800              		.loc 1 201 27 is_stmt 0 view .LVU225
 801 00d2 0023     		movs	r3, #0
 802 00d4 0293     		str	r3, [sp, #8]
 201:Core/Src/i2c_error_handler.c ****         HAL_GPIO_WritePin(GPIOB, GPIO_PIN_6, GPIO_PIN_SET);    // SCL high
 803              		.loc 1 201 9 view .LVU226
 804 00d6 D3E7     		b	.L60
 805              	.L70:
 806              	.LBE11:
 807              	.LBE7:
 206:Core/Src/i2c_error_handler.c ****     }
 207:Core/Src/i2c_error_handler.c ****     
 208:Core/Src/i2c_error_handler.c ****     /* Force reset I2C peripheral registers */
 209:Core/Src/i2c_error_handler.c ****     __HAL_RCC_I2C1_FORCE_RESET();
 808              		.loc 1 209 5 is_stmt 1 view .LVU227
 809 00d8 134C     		ldr	r4, .L71+12
 810              	.LVL49:
 811              		.loc 1 209 5 is_stmt 0 view .LVU228
 812 00da 236A     		ldr	r3, [r4, #32]
 813 00dc 43F40013 		orr	r3, r3, #2097152
 814 00e0 2362     		str	r3, [r4, #32]
 210:Core/Src/i2c_error_handler.c ****     HAL_Delay(5);
 815              		.loc 1 210 5 is_stmt 1 view .LVU229
 816 00e2 0520     		movs	r0, #5
 817 00e4 FFF7FEFF 		bl	HAL_Delay
 818              	.LVL50:
 211:Core/Src/i2c_error_handler.c ****     __HAL_RCC_I2C1_RELEASE_RESET();
 819              		.loc 1 211 5 view .LVU230
 820 00e8 236A     		ldr	r3, [r4, #32]
 821 00ea 23F40013 		bic	r3, r3, #2097152
 822 00ee 2362     		str	r3, [r4, #32]
 212:Core/Src/i2c_error_handler.c ****     HAL_Delay(5);
 823              		.loc 1 212 5 view .LVU231
 824 00f0 0520     		movs	r0, #5
 825 00f2 FFF7FEFF 		bl	HAL_Delay
 826              	.LVL51:
 213:Core/Src/i2c_error_handler.c ****     
ARM GAS  /tmp/cckYNZki.s 			page 20


 214:Core/Src/i2c_error_handler.c ****     /* Re-initialize I2C */
 215:Core/Src/i2c_error_handler.c ****     MX_I2C1_Init();
 827              		.loc 1 215 5 view .LVU232
 828 00f6 FFF7FEFF 		bl	MX_I2C1_Init
 829              	.LVL52:
 216:Core/Src/i2c_error_handler.c ****     
 217:Core/Src/i2c_error_handler.c ****     /* Clear state */
 218:Core/Src/i2c_error_handler.c ****     hi2c1.State = HAL_I2C_STATE_READY;
 830              		.loc 1 218 5 view .LVU233
 831              		.loc 1 218 17 is_stmt 0 view .LVU234
 832 00fa 094B     		ldr	r3, .L71+4
 833 00fc 2022     		movs	r2, #32
 834 00fe 83F83D20 		strb	r2, [r3, #61]
 219:Core/Src/i2c_error_handler.c ****     hi2c1.ErrorCode = HAL_I2C_ERROR_NONE;
 835              		.loc 1 219 5 is_stmt 1 view .LVU235
 836              		.loc 1 219 21 is_stmt 0 view .LVU236
 837 0102 0024     		movs	r4, #0
 838 0104 1C64     		str	r4, [r3, #64]
 220:Core/Src/i2c_error_handler.c ****     
 221:Core/Src/i2c_error_handler.c ****     /* Clear busy flag if still stuck */
 222:Core/Src/i2c_error_handler.c ****     I2C_ClearBusyFlag();
 839              		.loc 1 222 5 is_stmt 1 view .LVU237
 840 0106 FFF7FEFF 		bl	I2C_ClearBusyFlag
 841              	.LVL53:
 223:Core/Src/i2c_error_handler.c ****     
 224:Core/Src/i2c_error_handler.c ****     i2c_consecutive_failures = 0;
 842              		.loc 1 224 5 view .LVU238
 843              		.loc 1 224 30 is_stmt 0 view .LVU239
 844 010a 084B     		ldr	r3, .L71+16
 845 010c 1C60     		str	r4, [r3]
 225:Core/Src/i2c_error_handler.c ****     i2c_last_successful_transaction = HAL_GetTick();
 846              		.loc 1 225 5 is_stmt 1 view .LVU240
 847              		.loc 1 225 39 is_stmt 0 view .LVU241
 848 010e FFF7FEFF 		bl	HAL_GetTick
 849              	.LVL54:
 850              		.loc 1 225 37 view .LVU242
 851 0112 074B     		ldr	r3, .L71+20
 852 0114 1860     		str	r0, [r3]
 226:Core/Src/i2c_error_handler.c ****     
 227:Core/Src/i2c_error_handler.c ****     return HAL_OK;
 853              		.loc 1 227 5 is_stmt 1 view .LVU243
 228:Core/Src/i2c_error_handler.c **** }
 854              		.loc 1 228 1 is_stmt 0 view .LVU244
 855 0116 2046     		mov	r0, r4
 856 0118 0AB0     		add	sp, sp, #40
 857              	.LCFI10:
 858              		.cfi_def_cfa_offset 8
 859              		@ sp needed
 860 011a 10BD     		pop	{r4, pc}
 861              	.L72:
 862              		.align	2
 863              	.L71:
 864 011c 00000000 		.word	.LANCHOR4
 865 0120 00000000 		.word	hi2c1
 866 0124 00040240 		.word	1073873920
 867 0128 00380240 		.word	1073887232
 868 012c 00000000 		.word	.LANCHOR5
ARM GAS  /tmp/cckYNZki.s 			page 21


 869 0130 00000000 		.word	.LANCHOR6
 870              		.cfi_endproc
 871              	.LFE139:
 873              		.section	.text.I2C_HealthCheck,"ax",%progbits
 874              		.align	1
 875              		.global	I2C_HealthCheck
 876              		.syntax unified
 877              		.thumb
 878              		.thumb_func
 879              		.fpu fpv4-sp-d16
 881              	I2C_HealthCheck:
 882              	.LFB140:
 229:Core/Src/i2c_error_handler.c **** 
 230:Core/Src/i2c_error_handler.c **** /**
 231:Core/Src/i2c_error_handler.c ****   * @brief  Performs I2C health check by reading TCA9548A multiplexer
 232:Core/Src/i2c_error_handler.c ****   * @retval HAL_OK if bus is healthy, HAL_ERROR otherwise
 233:Core/Src/i2c_error_handler.c ****   */
 234:Core/Src/i2c_error_handler.c **** HAL_StatusTypeDef I2C_HealthCheck(void)
 235:Core/Src/i2c_error_handler.c **** {
 883              		.loc 1 235 1 is_stmt 1 view -0
 884              		.cfi_startproc
 885              		@ args = 0, pretend = 0, frame = 8
 886              		@ frame_needed = 0, uses_anonymous_args = 0
 887 0000 10B5     		push	{r4, lr}
 888              	.LCFI11:
 889              		.cfi_def_cfa_offset 8
 890              		.cfi_offset 4, -8
 891              		.cfi_offset 14, -4
 892 0002 84B0     		sub	sp, sp, #16
 893              	.LCFI12:
 894              		.cfi_def_cfa_offset 24
 236:Core/Src/i2c_error_handler.c ****     static uint32_t last_check = 0;
 895              		.loc 1 236 5 view .LVU246
 237:Core/Src/i2c_error_handler.c ****     uint32_t now = HAL_GetTick();
 896              		.loc 1 237 5 view .LVU247
 897              		.loc 1 237 20 is_stmt 0 view .LVU248
 898 0004 FFF7FEFF 		bl	HAL_GetTick
 899              	.LVL55:
 238:Core/Src/i2c_error_handler.c ****     
 239:Core/Src/i2c_error_handler.c ****     /* Only check periodically */
 240:Core/Src/i2c_error_handler.c ****     if (now - last_check < HEALTH_CHECK_INTERVAL_MS) {
 900              		.loc 1 240 5 is_stmt 1 view .LVU249
 901              		.loc 1 240 13 is_stmt 0 view .LVU250
 902 0008 114B     		ldr	r3, .L79
 903 000a 1B68     		ldr	r3, [r3]
 904 000c C31A     		subs	r3, r0, r3
 905              		.loc 1 240 8 view .LVU251
 906 000e 41F28732 		movw	r2, #4999
 907 0012 9342     		cmp	r3, r2
 908 0014 02D8     		bhi	.L78
 241:Core/Src/i2c_error_handler.c ****         return HAL_OK;
 909              		.loc 1 241 16 view .LVU252
 910 0016 0020     		movs	r0, #0
 911              	.LVL56:
 912              	.L74:
 242:Core/Src/i2c_error_handler.c ****     }
 243:Core/Src/i2c_error_handler.c ****     last_check = now;
ARM GAS  /tmp/cckYNZki.s 			page 22


 244:Core/Src/i2c_error_handler.c ****     
 245:Core/Src/i2c_error_handler.c ****     /* Try to read from TCA9548A multiplexer (address 0x70) */
 246:Core/Src/i2c_error_handler.c ****     uint8_t dummy;
 247:Core/Src/i2c_error_handler.c ****     HAL_StatusTypeDef status = HAL_I2C_Master_Receive(&hi2c1, 0x70 << 1, &dummy, 1, 50);
 248:Core/Src/i2c_error_handler.c ****     
 249:Core/Src/i2c_error_handler.c ****     if (status == HAL_OK) {
 250:Core/Src/i2c_error_handler.c ****         i2c_consecutive_failures = 0;
 251:Core/Src/i2c_error_handler.c ****         i2c_last_successful_transaction = now;
 252:Core/Src/i2c_error_handler.c ****         return HAL_OK;
 253:Core/Src/i2c_error_handler.c ****     } else {
 254:Core/Src/i2c_error_handler.c ****         i2c_consecutive_failures++;
 255:Core/Src/i2c_error_handler.c ****         /* Just track failures, don't auto-reset - let main loop decide */
 256:Core/Src/i2c_error_handler.c ****         return HAL_ERROR;
 257:Core/Src/i2c_error_handler.c ****     }
 258:Core/Src/i2c_error_handler.c **** }
 913              		.loc 1 258 1 view .LVU253
 914 0018 04B0     		add	sp, sp, #16
 915              	.LCFI13:
 916              		.cfi_remember_state
 917              		.cfi_def_cfa_offset 8
 918              		@ sp needed
 919 001a 10BD     		pop	{r4, pc}
 920              	.LVL57:
 921              	.L78:
 922              	.LCFI14:
 923              		.cfi_restore_state
 924              		.loc 1 258 1 view .LVU254
 925 001c 0446     		mov	r4, r0
 243:Core/Src/i2c_error_handler.c ****     
 926              		.loc 1 243 5 is_stmt 1 view .LVU255
 243:Core/Src/i2c_error_handler.c ****     
 927              		.loc 1 243 16 is_stmt 0 view .LVU256
 928 001e 0C4B     		ldr	r3, .L79
 929 0020 1860     		str	r0, [r3]
 246:Core/Src/i2c_error_handler.c ****     HAL_StatusTypeDef status = HAL_I2C_Master_Receive(&hi2c1, 0x70 << 1, &dummy, 1, 50);
 930              		.loc 1 246 5 is_stmt 1 view .LVU257
 247:Core/Src/i2c_error_handler.c ****     
 931              		.loc 1 247 5 view .LVU258
 247:Core/Src/i2c_error_handler.c ****     
 932              		.loc 1 247 32 is_stmt 0 view .LVU259
 933 0022 3223     		movs	r3, #50
 934 0024 0093     		str	r3, [sp]
 935 0026 0123     		movs	r3, #1
 936 0028 0DF10F02 		add	r2, sp, #15
 937 002c E021     		movs	r1, #224
 938 002e 0948     		ldr	r0, .L79+4
 939              	.LVL58:
 247:Core/Src/i2c_error_handler.c ****     
 940              		.loc 1 247 32 view .LVU260
 941 0030 FFF7FEFF 		bl	HAL_I2C_Master_Receive
 942              	.LVL59:
 249:Core/Src/i2c_error_handler.c ****         i2c_consecutive_failures = 0;
 943              		.loc 1 249 5 is_stmt 1 view .LVU261
 249:Core/Src/i2c_error_handler.c ****         i2c_consecutive_failures = 0;
 944              		.loc 1 249 8 is_stmt 0 view .LVU262
 945 0034 28B9     		cbnz	r0, .L75
 250:Core/Src/i2c_error_handler.c ****         i2c_last_successful_transaction = now;
ARM GAS  /tmp/cckYNZki.s 			page 23


 946              		.loc 1 250 9 is_stmt 1 view .LVU263
 250:Core/Src/i2c_error_handler.c ****         i2c_last_successful_transaction = now;
 947              		.loc 1 250 34 is_stmt 0 view .LVU264
 948 0036 084B     		ldr	r3, .L79+8
 949 0038 0022     		movs	r2, #0
 950 003a 1A60     		str	r2, [r3]
 251:Core/Src/i2c_error_handler.c ****         return HAL_OK;
 951              		.loc 1 251 9 is_stmt 1 view .LVU265
 251:Core/Src/i2c_error_handler.c ****         return HAL_OK;
 952              		.loc 1 251 41 is_stmt 0 view .LVU266
 953 003c 074B     		ldr	r3, .L79+12
 954 003e 1C60     		str	r4, [r3]
 252:Core/Src/i2c_error_handler.c ****     } else {
 955              		.loc 1 252 9 is_stmt 1 view .LVU267
 252:Core/Src/i2c_error_handler.c ****     } else {
 956              		.loc 1 252 16 is_stmt 0 view .LVU268
 957 0040 EAE7     		b	.L74
 958              	.L75:
 254:Core/Src/i2c_error_handler.c ****         /* Just track failures, don't auto-reset - let main loop decide */
 959              		.loc 1 254 9 is_stmt 1 view .LVU269
 254:Core/Src/i2c_error_handler.c ****         /* Just track failures, don't auto-reset - let main loop decide */
 960              		.loc 1 254 33 is_stmt 0 view .LVU270
 961 0042 054A     		ldr	r2, .L79+8
 962 0044 1368     		ldr	r3, [r2]
 963 0046 0133     		adds	r3, r3, #1
 964 0048 1360     		str	r3, [r2]
 256:Core/Src/i2c_error_handler.c ****     }
 965              		.loc 1 256 9 is_stmt 1 view .LVU271
 256:Core/Src/i2c_error_handler.c ****     }
 966              		.loc 1 256 16 is_stmt 0 view .LVU272
 967 004a 0120     		movs	r0, #1
 968              	.LVL60:
 256:Core/Src/i2c_error_handler.c ****     }
 969              		.loc 1 256 16 view .LVU273
 970 004c E4E7     		b	.L74
 971              	.L80:
 972 004e 00BF     		.align	2
 973              	.L79:
 974 0050 00000000 		.word	.LANCHOR7
 975 0054 00000000 		.word	hi2c1
 976 0058 00000000 		.word	.LANCHOR5
 977 005c 00000000 		.word	.LANCHOR6
 978              		.cfi_endproc
 979              	.LFE140:
 981              		.section	.text.I2C_IsHealthy,"ax",%progbits
 982              		.align	1
 983              		.global	I2C_IsHealthy
 984              		.syntax unified
 985              		.thumb
 986              		.thumb_func
 987              		.fpu fpv4-sp-d16
 989              	I2C_IsHealthy:
 990              	.LFB141:
 259:Core/Src/i2c_error_handler.c **** 
 260:Core/Src/i2c_error_handler.c **** /**
 261:Core/Src/i2c_error_handler.c ****   * @brief  Checks if I2C bus is currently healthy
 262:Core/Src/i2c_error_handler.c ****   * @retval 1 if healthy, 0 if unhealthy
ARM GAS  /tmp/cckYNZki.s 			page 24


 263:Core/Src/i2c_error_handler.c ****   */
 264:Core/Src/i2c_error_handler.c **** uint8_t I2C_IsHealthy(void)
 265:Core/Src/i2c_error_handler.c **** {
 991              		.loc 1 265 1 is_stmt 1 view -0
 992              		.cfi_startproc
 993              		@ args = 0, pretend = 0, frame = 0
 994              		@ frame_needed = 0, uses_anonymous_args = 0
 995              		@ link register save eliminated.
 266:Core/Src/i2c_error_handler.c ****     /* Check if too many consecutive failures */
 267:Core/Src/i2c_error_handler.c ****     if (i2c_consecutive_failures >= MAX_CONSECUTIVE_FAILURES) {
 996              		.loc 1 267 5 view .LVU275
 997              		.loc 1 267 34 is_stmt 0 view .LVU276
 998 0000 0B4B     		ldr	r3, .L86
 999 0002 1B68     		ldr	r3, [r3]
 1000              		.loc 1 267 8 view .LVU277
 1001 0004 312B     		cmp	r3, #49
 1002 0006 0DD8     		bhi	.L83
 268:Core/Src/i2c_error_handler.c ****         return 0;
 269:Core/Src/i2c_error_handler.c ****     }
 270:Core/Src/i2c_error_handler.c ****     
 271:Core/Src/i2c_error_handler.c ****     /* Check if BUSY flag is stuck */
 272:Core/Src/i2c_error_handler.c ****     if (hi2c1.Instance->SR2 & I2C_SR2_BUSY) {
 1003              		.loc 1 272 5 is_stmt 1 view .LVU278
 1004              		.loc 1 272 14 is_stmt 0 view .LVU279
 1005 0008 0A4B     		ldr	r3, .L86+4
 1006 000a 1B68     		ldr	r3, [r3]
 1007              		.loc 1 272 23 view .LVU280
 1008 000c 9B69     		ldr	r3, [r3, #24]
 1009              		.loc 1 272 8 view .LVU281
 1010 000e 13F0020F 		tst	r3, #2
 1011 0012 09D0     		beq	.L84
 273:Core/Src/i2c_error_handler.c ****         if (hi2c1.State == HAL_I2C_STATE_READY) {
 1012              		.loc 1 273 9 is_stmt 1 view .LVU282
 1013              		.loc 1 273 18 is_stmt 0 view .LVU283
 1014 0014 074B     		ldr	r3, .L86+4
 1015 0016 93F83D30 		ldrb	r3, [r3, #61]	@ zero_extendqisi2
 1016 001a DBB2     		uxtb	r3, r3
 1017              		.loc 1 273 12 view .LVU284
 1018 001c 202B     		cmp	r3, #32
 1019 001e 05D0     		beq	.L85
 274:Core/Src/i2c_error_handler.c ****             /* BUSY flag stuck while HAL thinks it's ready - unhealthy */
 275:Core/Src/i2c_error_handler.c ****             return 0;
 276:Core/Src/i2c_error_handler.c ****         }
 277:Core/Src/i2c_error_handler.c ****     }
 278:Core/Src/i2c_error_handler.c ****     
 279:Core/Src/i2c_error_handler.c ****     return 1;
 1020              		.loc 1 279 12 view .LVU285
 1021 0020 0120     		movs	r0, #1
 1022 0022 7047     		bx	lr
 1023              	.L83:
 268:Core/Src/i2c_error_handler.c ****     }
 1024              		.loc 1 268 16 view .LVU286
 1025 0024 0020     		movs	r0, #0
 1026 0026 7047     		bx	lr
 1027              	.L84:
 1028              		.loc 1 279 12 view .LVU287
 1029 0028 0120     		movs	r0, #1
ARM GAS  /tmp/cckYNZki.s 			page 25


 1030 002a 7047     		bx	lr
 1031              	.L85:
 275:Core/Src/i2c_error_handler.c ****         }
 1032              		.loc 1 275 20 view .LVU288
 1033 002c 0020     		movs	r0, #0
 280:Core/Src/i2c_error_handler.c **** }
 1034              		.loc 1 280 1 view .LVU289
 1035 002e 7047     		bx	lr
 1036              	.L87:
 1037              		.align	2
 1038              	.L86:
 1039 0030 00000000 		.word	.LANCHOR5
 1040 0034 00000000 		.word	hi2c1
 1041              		.cfi_endproc
 1042              	.LFE141:
 1044              		.global	i2c_recovery_count
 1045              		.global	i2c_arbitration_lost_count
 1046              		.global	i2c_bus_error_count
 1047              		.global	i2c_timeout_count
 1048              		.global	i2c_error_count
 1049              		.section	.bss.i2c_arbitration_lost_count,"aw",%nobits
 1050              		.align	2
 1051              		.set	.LANCHOR3,. + 0
 1054              	i2c_arbitration_lost_count:
 1055 0000 00000000 		.space	4
 1056              		.section	.bss.i2c_bus_error_count,"aw",%nobits
 1057              		.align	2
 1058              		.set	.LANCHOR2,. + 0
 1061              	i2c_bus_error_count:
 1062 0000 00000000 		.space	4
 1063              		.section	.bss.i2c_consecutive_failures,"aw",%nobits
 1064              		.align	2
 1065              		.set	.LANCHOR5,. + 0
 1068              	i2c_consecutive_failures:
 1069 0000 00000000 		.space	4
 1070              		.section	.bss.i2c_error_count,"aw",%nobits
 1071              		.align	2
 1072              		.set	.LANCHOR0,. + 0
 1075              	i2c_error_count:
 1076 0000 00000000 		.space	4
 1077              		.section	.bss.i2c_last_successful_transaction,"aw",%nobits
 1078              		.align	2
 1079              		.set	.LANCHOR6,. + 0
 1082              	i2c_last_successful_transaction:
 1083 0000 00000000 		.space	4
 1084              		.section	.bss.i2c_recovery_count,"aw",%nobits
 1085              		.align	2
 1086              		.set	.LANCHOR4,. + 0
 1089              	i2c_recovery_count:
 1090 0000 00000000 		.space	4
 1091              		.section	.bss.i2c_timeout_count,"aw",%nobits
 1092              		.align	2
 1093              		.set	.LANCHOR1,. + 0
 1096              	i2c_timeout_count:
 1097 0000 00000000 		.space	4
 1098              		.section	.bss.last_check.8675,"aw",%nobits
 1099              		.align	2
ARM GAS  /tmp/cckYNZki.s 			page 26


 1100              		.set	.LANCHOR7,. + 0
 1103              	last_check.8675:
 1104 0000 00000000 		.space	4
 1105              		.text
 1106              	.Letext0:
 1107              		.file 2 "/usr/lib/gcc/arm-none-eabi/9.2.1/include/stdint.h"
 1108              		.file 3 "Drivers/CMSIS/Include/core_cm4.h"
 1109              		.file 4 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/system_stm32f4xx.h"
 1110              		.file 5 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f446xx.h"
 1111              		.file 6 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
 1112              		.file 7 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_gpio.h"
 1113              		.file 8 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 1114              		.file 9 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_i2c.h"
 1115              		.file 10 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal.h"
 1116              		.file 11 "Core/Inc/i2c.h"
 1117              		.file 12 "Core/Inc/i2c_dma_manager.h"
ARM GAS  /tmp/cckYNZki.s 			page 27


DEFINED SYMBOLS
                            *ABS*:0000000000000000 i2c_error_handler.c
     /tmp/cckYNZki.s:18     .text.HAL_I2C_ErrorCallback:0000000000000000 $t
     /tmp/cckYNZki.s:26     .text.HAL_I2C_ErrorCallback:0000000000000000 HAL_I2C_ErrorCallback
     /tmp/cckYNZki.s:141    .text.HAL_I2C_ErrorCallback:0000000000000080 $d
     /tmp/cckYNZki.s:152    .text.I2C_RecoverBus:0000000000000000 $t
     /tmp/cckYNZki.s:159    .text.I2C_RecoverBus:0000000000000000 I2C_RecoverBus
     /tmp/cckYNZki.s:311    .text.I2C_RecoverBus:00000000000000b8 $d
     /tmp/cckYNZki.s:317    .text.I2C_GetErrorStats:0000000000000000 $t
     /tmp/cckYNZki.s:324    .text.I2C_GetErrorStats:0000000000000000 I2C_GetErrorStats
     /tmp/cckYNZki.s:429    .text.I2C_GetErrorStats:0000000000000048 $d
     /tmp/cckYNZki.s:437    .text.I2C_ResetErrorStats:0000000000000000 $t
     /tmp/cckYNZki.s:444    .text.I2C_ResetErrorStats:0000000000000000 I2C_ResetErrorStats
     /tmp/cckYNZki.s:481    .text.I2C_ResetErrorStats:000000000000001c $d
     /tmp/cckYNZki.s:491    .text.I2C_ClearBusyFlag:0000000000000000 $t
     /tmp/cckYNZki.s:498    .text.I2C_ClearBusyFlag:0000000000000000 I2C_ClearBusyFlag
     /tmp/cckYNZki.s:564    .text.I2C_ClearBusyFlag:000000000000003c $d
     /tmp/cckYNZki.s:569    .text.I2C_ForceReset:0000000000000000 $t
     /tmp/cckYNZki.s:576    .text.I2C_ForceReset:0000000000000000 I2C_ForceReset
     /tmp/cckYNZki.s:864    .text.I2C_ForceReset:000000000000011c $d
     /tmp/cckYNZki.s:874    .text.I2C_HealthCheck:0000000000000000 $t
     /tmp/cckYNZki.s:881    .text.I2C_HealthCheck:0000000000000000 I2C_HealthCheck
     /tmp/cckYNZki.s:974    .text.I2C_HealthCheck:0000000000000050 $d
     /tmp/cckYNZki.s:982    .text.I2C_IsHealthy:0000000000000000 $t
     /tmp/cckYNZki.s:989    .text.I2C_IsHealthy:0000000000000000 I2C_IsHealthy
     /tmp/cckYNZki.s:1039   .text.I2C_IsHealthy:0000000000000030 $d
     /tmp/cckYNZki.s:1089   .bss.i2c_recovery_count:0000000000000000 i2c_recovery_count
     /tmp/cckYNZki.s:1054   .bss.i2c_arbitration_lost_count:0000000000000000 i2c_arbitration_lost_count
     /tmp/cckYNZki.s:1061   .bss.i2c_bus_error_count:0000000000000000 i2c_bus_error_count
     /tmp/cckYNZki.s:1096   .bss.i2c_timeout_count:0000000000000000 i2c_timeout_count
     /tmp/cckYNZki.s:1075   .bss.i2c_error_count:0000000000000000 i2c_error_count
     /tmp/cckYNZki.s:1050   .bss.i2c_arbitration_lost_count:0000000000000000 $d
     /tmp/cckYNZki.s:1057   .bss.i2c_bus_error_count:0000000000000000 $d
     /tmp/cckYNZki.s:1064   .bss.i2c_consecutive_failures:0000000000000000 $d
     /tmp/cckYNZki.s:1068   .bss.i2c_consecutive_failures:0000000000000000 i2c_consecutive_failures
     /tmp/cckYNZki.s:1071   .bss.i2c_error_count:0000000000000000 $d
     /tmp/cckYNZki.s:1078   .bss.i2c_last_successful_transaction:0000000000000000 $d
     /tmp/cckYNZki.s:1082   .bss.i2c_last_successful_transaction:0000000000000000 i2c_last_successful_transaction
     /tmp/cckYNZki.s:1085   .bss.i2c_recovery_count:0000000000000000 $d
     /tmp/cckYNZki.s:1092   .bss.i2c_timeout_count:0000000000000000 $d
     /tmp/cckYNZki.s:1099   .bss.last_check.8675:0000000000000000 $d
     /tmp/cckYNZki.s:1103   .bss.last_check.8675:0000000000000000 last_check.8675

UNDEFINED SYMBOLS
HAL_I2C_GetError
I2C_DMA_HandleError
HAL_Delay
MX_I2C1_Init
HAL_I2C_DeInit
HAL_GPIO_Init
HAL_GPIO_WritePin
hi2c1
HAL_GetTick
HAL_I2C_Master_Receive
